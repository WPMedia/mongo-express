{% extends 'layout.html' %}

{% block breadcrumb %}

{% include 'breadcrumb.html' %}

{% endblock %}

{% block title %}Backup database{% endblock %}




{% block content %}


<h2>{{action}} Databases</h2>

<div class="panel-group" id="accordion" role="tablist" aria-multiselectable="true">
  {% for db in databases %}
  <div class="panel panel-default">
    <div class="panel-heading" role="tab" id="heading-{{loop.index}}">
      <h4 class="panel-title">
        <a class="collapsed" role="button" data-toggle="collapse" data-parent="#accordion" href="#collapse-{{loop.index}}" aria-expanded="false" aria-controls="collapse-{{loop.index}}">
          {{db}}
        </a>
      </h4>
    </div>
    <div id="collapse-{{loop.index}}" class="panel-collapse collapse" role="tabpanel" aria-labelledby="heading-{{loop.index}}">
      <div class="panel-body">
        <h5 style="margin-top:0">Choose the collections for backup</h5>
        <form name="{{db}}-collections">
          <div class="checkbox">
            <label>
              <input type="checkbox" name="{{db}}-collections" value="all"> All Collections
            </label>
          </div>
          {% for collection in collections[db] %}
            <div class="checkbox" style="padding-left:10px">
              <label>
                <input type="checkbox" name="{{db}}-collections" value="{{collection}}"> {{collection}}
              </label>
            </div>
          {% endfor %}
          <!--<button type="submit" class="btn btn-default">Backup</button>-->
          <button class="btn btn-success backup-button" database-name="{{ db }}" childof="db-{{ db }}">
          <span class="glyphicon glyphicon-copy "></span> Backup
          </button>
        </form>
    </div>
  </div>
  </div>
  {% endfor %}

</div>


{% if !settings.read_only %}
<div id="confirm-backup" class="modal fade" role="dialog" aria-labelledby="confirmBackupLabel">
  <div class="modal-dialog" role="document">
    <div class="modal-content">

      <div class="modal-header">
        <button type="button" class="close" data-dismiss="modal"><span aria-hidden="true">&times;</span></button>
        <h4 class="modal-title" id="myModalLabel">Backup database</h4>
      </div>

      <div class="modal-body">
        <p>
          Be careful! You are about to backup whole <strong><span id="modal-database-name"></span></strong> database.
        </p>
        <p>
          <label for="confirmation-input">Type the database name to proceed.</label>
          <input type="text" id="confirmation-input" name="confirmation-input" shouldbe="" value="" />
        </p>
      </div>

      <div class="modal-footer">
        <button type="button" data-dismiss="modal" class="btn  btn-success" id="backup">Backup</button>
        <button type="button" data-dismiss="modal" class="btn btn-default">Cancel</button>
      </div>
    </div>
  </div>
</div>



{% endif %}

{#
  # Still need to add global lock time stats and replica set stats
#}

{% endblock %}
